# 机器学习

## 1 机器学习体系介绍

### 1.1 机器学习与传统编程

- ##### 传统编程

在传统编程中，你需要对程序的行为进行硬编码。对于任何解决方案，第一个任务都是创建最合适的算法并编写代码。然后，必须设置输入参数，实际上，如果实现的算法是正确的，它将产生预期的结果。如下面流程图所示，在传统编程中，在对问题进行研究之后，对解决方案按照编写规则进行代码编写，之后对代码、算法进行评估。如果理想，正常运行从而产生预期的结果，如果不理想；分析错误重新对问题进行研究分析。

![1574650573465](image\1574650573465.png)

- ##### 机器学习

在机器学习中，你将大量内容留给机器去学习数据。机器学习的一个显著特征是不需要构建模型。这个复杂而有意义的任务是由机器学习算法执行的。如下图所示，与传统编程最大的区别在于机器学习把数据交给机器进行学习，而传统编程由程序员自己编写。

![1574651451851](image\1574651451851.png)

- ##### 升级机器学习

在我们进行机器学习时，数据是一般都会发生一些变化，比如说，产生一些新的数据，那我们就需要对数据进行一定的升级，然后对升级之后的数据重新进行训练。如果，我们按照之前的方法，需要的步骤就比较多，而且比较麻烦。我们可以对整个流程进行升级，让机器去适应这个流程，这样可以大大的减少我们工作。

![1574652486332](image\1574652486332.png)

- ##### 数据挖掘

应用机器学习技术来训练海量数据，可以帮助我们发 现那些此前并非立见端倪的模式，称为数据挖掘。

![1574652551466](image\1574652551466.png)

- ##### 传统编程与机器学习的区别
  - 解决方案需要规则列表超长问题，通过机器学习可以简化代码，提升执行表现 
  - 对于传统技术手段根本无法解决的复杂问题，通过机器学习可以找到方案 
  - 对于环境波动：机器学习系统可以适应新的数据 
  - 从复杂问题和海量数据中获得更多人类未曾意识到的关联性或者趋势

### 1.2 机器学习原理与学习方法

#### 1.2.1 机器学习原理

- 机器学习是指：让机器可以自主获得事物规律。要让机器可以 “学习”，必须将生活中的数据（包括但不限于图像、文字、语音）数值化，将不同事物的变化和关联转化为运算。
- 机器学习可以成立的原因是：概念和数值、关系和运算可以相互映射

- 机器学习三要素之数据、模型、算法
  - 数据：还未转换为机器可以识别的数据样本
  - 向量空间模型（VSM, Vector Space Model）：负责将格式（文字、图片、音频、视频）转化为一个个向量
  - 训练过程需要依据某种章法进行运算。这个章法，就是算法
  - 模型是机器学习的结果，而这个学习的过程称为训练(Train)

![1574660977780](image\1574660977780.png)

我们通过下面的例子来加深对机器学习原理的学习。

![1574662019870](image\1574662019870.png)

#### 1.2.2 学习方法

机器学习是一门多领域交叉学科，涉及概率论、统计学、逼近论、凸分析、算法复杂度理论等多门学科。

![1574661841813](image\1574661841813.png)

### 1.3 机器学习中的数学知识

下图是对知识掌握与前景发展的大体结构图。

![1574663832120](image\1574663832120.png)

#### 1.3.1 基础概念

- 微积分基础 
  - 泰勒公式 ：是一个用函数在某点的信息描述其附近取值的公式
  - 导数：导数是函数的局部性质。一个函数在某一点的导数描述了这个函数在这一点附近的变化率
  - 梯度：梯度的本意是一个向量（矢量），表示某一函数在该点处的方向导数沿着该方向取得最大值，即函数在该点处沿着该方向（此梯度的方向）变化最快，变化率最大（为该梯度的模）。
- 概率与统计基础 
  - 概率公式：概率，它是反映随机事件出现的可能性大小。
  - 常见分布：是指样本估计量的分布
  - 常见统计量：是统计理论中用来对数据进行分析、检验的变量
- 线性代数基础 
  - 矩阵乘法的几何意义：指的是一般矩阵乘积。一个m×n的矩阵就是m行n列的一个数阵。由于它把许多数据紧凑地集中到了一起，所以有时候可以简便地表示一些复杂的模型

#### 1.3.2 概率统计与机器学习的关系

- 统计本质是分布，机器学习训练出来的是模型，模型可能包含了很 多分布 
- 训练与预测过程的一个核心评价指标就是模型的误差 
- 误差本身就可以是概率的形式，与概率紧密相关
- 对误差的不同定义方式就演化成了不同损失函数的定义方式
- 机器学习是概率与统计和计算机编程的结合

#### 1.3.3 推荐书籍

- Christopher M. Bishop, Pattern Recognition and Machine Learning, Springer-Verlag, 2006 
- Kevin P. Murphy, Machine Learning:A Probabilistic Perspective, The MIT Press, 2012  
- 李航，统计学习方法，清华大学出版社，2012 
- 周志华， 机器学习，清华大学出版社，2016 
- Machine Learning，Andrew Ng，coursera 
- 机器学习基石/技术，林轩田，coursera

### 1.4 总结

- 机器学习模型本质就是一个函数，函数运算所有的特征，得到一个值 
- 数据挖掘基本等于机器学习，统计学是机器学习的子集，凹集，模式识别也是约等于数据挖掘，原始的模式识别更接近于匹配和规则，现在的机器学习更偏重于统计 
- 统计是取出一部分数据，得知分布情况，求全集的分布情况。统计是对全量 的一种关测，所以成本会很少，如果能用抽样解决的问题，尽量不要用机器 学习来做，机器学习成本比较高，一般用统计和概率弄一下就可以了 
- 数据挖掘建模之前需要对数据进行清洗处理 ，了解数据的关联性很重要， bat的数据挖掘组，需要在进入之前，在数据组轮值半年岗

## 2 机器学习分类

### 2.1 机器学习应用领域

![1574665597238](image\1574665597238.png)

- ##### 计算机视觉

　让机器像人一样看世界，看到图像，视频等媒体。会把图像进行识别，分类。

- ##### 语音识别

与机器进行语音交流，让机器明白你说什么

- ##### NLP自然语言处理

让机器像人一样理解语言，理解人写的文字等的含义。并作出一定的反应。

- ##### 统计-推荐系统

推荐系统主要解决信息过载的问题。它有两个目的：一是让用户找到感兴趣的物品；二是让物品出现在对它感兴趣的用户前。

- ##### 数据挖掘

数据挖掘主要是应用于大数据领域，利用机器学习的模型来挖掘数据中的潜在价值。发现数据之间的关系。

- ##### 模式识别

给机器各种特征描述，从而让机器对未知的事物进行判断

### 2.2 机器学习分类

机器学习分为四种，分别是监督学习、无监督学习、半监督学习和增强学习。使用比较多的的是监督学习与无监督学习。

![1574670085958](image\1574670085958.png)

在解决问题的时候，必须考虑下面两个问题：一、使用机器学习算法的目的，想要算法完成何种任务；二、需要分析或者收集的数据是什么。

首先考虑使用机器学习算法的目的。如果想要预测目标变量的值，则可以选择监督学习算法，否则可以选择无监督学习算法，确定选择监督学习算法之后，需要进一步确定目标变量类型，如果目标变量是离散型，则可以选择分类算法；如果目标变量是连续的数值，则需要选择回归算法。

如果不想预测目标变量的值，则可以选择无监督算法。进一步分析是否需要将数据划分为离散的组。如果这是唯一的需求，则使用聚类算法。

#### 2.2.1 监督学习

利用无标签的数据学习数据的分布或数据与数 据之间的关系被称作无监督学习，也就是说，通过过往的一些数据的特征以及最终结果来进行训练的方式就是监督学习法，监督学习算法的训练数据源需要由特征值以及目标队列两部分组成。

- ##### 训练

用来训练模型，估计参数

![1574673053106](image\1574673053106.png)

- ##### 预测

用来测试和评估训练出来的模型好坏，不能用于训练模型

![1574673085530](image\1574673085530.png)

- ##### 总结

监督学习是从标记的训练数据来推断一个功能的机器学习任务。然后使用预测数据对训练出来的模型进行验证。

![1574673126858](image\1574673126858.png)监督学习依赖于每个样本，可以得到每个特征序列映射到的确切的目标值是什么，所以常用于回归以及分类场景。常见的监督学习算法有：K近邻、朴素贝叶斯、决策树、随机森林、逻辑回归、线性回归、支持向量机SVM等。

- ##### k-近邻算法

k-近邻算法采用测量不同特征值之间的距离来进行分类

- 优点：精度高、对异常值不敏感、无数据输入假定
- 缺点：计算复杂度高、空间复杂度高
- 使用数据范围：数值型和标称型

本案例使用最著名的”鸢尾“数据集，该数据集曾经被Fisher用在经典论文中，目前作为教科书般的数据样本预存在Scikit-learn的工具包中。

```Python
from sklearn.datasets import load_iris
from sklearn.cross_validation import train_test_split
from sklearn.preprocessing import StandardScaler
from sklearn.neighbors import KNeighborsClassifier
from sklearn.metrics import classification_report
from sklearn.model_selection import GridSearchCV

def knniris():
    """
    鸢尾花分类
    :return: None
    """

    # 数据集获取和分割
    lr = load_iris()

    x_train, x_test, y_train, y_test = train_test_split(lr.data, lr.target, test_size=0.25)

    # 进行标准化
    std = StandardScaler()

    x_train = std.fit_transform(x_train)
    x_test = std.transform(x_test)

    # estimator流程
    knn = KNeighborsClassifier()

    # # 得出模型
    # knn.fit(x_train,y_train)
    #
    # # 进行预测或者得出精度
    # y_predict = knn.predict(x_test)
    #
    # # score = knn.score(x_test,y_test)

    # 通过网格搜索,n_neighbors为参数列表
    param = {"n_neighbors": [3, 5, 7]}

    gs = GridSearchCV(knn, param_grid=param, cv=10)

    # 建立模型
    gs.fit(x_train,y_train)

    # print(gs)

    # 预测数据

    print(gs.score(x_test,y_test))

    # 分类模型的精确率和召回率

    # print("每个类别的精确率与召回率：",classification_report(y_test, y_predict,target_names=lr.target_names))

    return None

if __name__ == "__main__":
    knniris()
```













#### 2.2.2 无监督学习

训练样本不依赖于打标数据的机器学习算法，它主要是用来解决一些聚类场景的问题。相较于监督学习，无监督学习的一大好处就是不依赖于打标数据。

- ##### 训练

![1574673174188](image\1574673174188.png)



- ##### 预测

![1574673211059](image\1574673211059.png)



- ##### 总结

![1574673236228](image\1574673236228.png)











常见的无监督学习算法有:K-Means、DBSCAN、协同过滤等。













#### 2.2.3 监督与无监督总结

- 分类比回归要应用广 
- 监督学习用的比较多，无监督一般属于辅助性的 
- 深度学习可以做监督无监督强化，如果对精度要求不高的话，没必要用到深度学习 
- sklearn 实现了所有算法，sklean也可以并行化，但是在海量数据情况下，需要分布式，就 不太好用了 
- 用机器学习来解决，关键还是你抽象问题的能力，把现实中的业务抽象成机器学习模型 
- 考虑机器学习处理问题：问题是分类还是回归，是监督还是无监督，数据量够不够，如何挑 选特征，解决实际问题越简单越好，能用规则先用规则，if else 加上判断 放上一些权重，然 后能用统计的先用统计来做，如果对精度和实时性要求比较高，就要上算法，精度要求越 高，算法就越复杂，对实时性要求高，算法会尽量简单，执行会并行化

以上是两种常见的机器学习方式，监督与无监督的所有内容，下面简单的介绍一下，其他两种不常用的机器学习方式，半监督与强化学习(了解即可)。

#### 2.2.4 强化学习

是一种比较复杂的机器学习种类， 强调的是系统与外界不断地交互，获得外界的反馈，然后决定自身的行为。强化学习主要是针对流程中不断需要推理的场景，比如:隐马尔可夫。









#### 2.2.5 半监督学习

通过对样本的部分打标来进行机器学习算法的使用，很多半监督学习算法都是监督学习算法的变形。半监督学习解决的是一些打标数据比较难获得的分类场景，比如：标签传播、

















































## 3 机器学习关键问题







## 4 分类训练







## 5 性能考核







## 6 多类别分类器





## 7 垃圾邮件分类



